<link rel="stylesheet" href="../base.css">

<canvas id="canvas" style="width: 100%; height: 100%"></canvas>

<script type="module">
  import { AnimatedCanvas } from '../src/common/AnimatedCanvas.js';

  import { Board } from '../src/Board.js';
  
  
  const Scale = 36;
  
  const canvas = new AnimatedCanvas( Scale * Board.Size, Scale * Board.Size, document.getElementById( 'canvas' ) );

  const board = new Board();

  
  canvas.update = ( dt ) => {
    if ( !board.update( dt ) ) {
      canvas.stop();
    }
  }

  canvas.draw = ( ctx ) => {
    ctx.scale( Scale, Scale );
    board.draw( ctx, Scale );
  }

  canvas.start();

  document.addEventListener( 'click', ( e ) => {
    const col = Math.round( e.clientX / Scale );
    const row = Math.round( e.clientY / Scale );

    const move = board.getMove( col, row );

    console.log( move );

    board.applyMove( move );
    canvas.start();
  } );

  document.addEventListener( 'keydown', ( e ) => {
    board.undo();
    canvas.start();
  } );

</script>